<html>
<head>
           <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
		   <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		   <meta charset="utf-8">
		   <meta property="og:title" content="Chiayi OpenData school in TGOS">
		   <meta property="og:description" content="Chiayi X OpenData X school X TGOS">
		   <meta property="og:type" content="website">
           <title>Chiayi X OpenData X school X TGOS</title>
		   <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
           <!--呼叫TGOS MAP API (lite)-->
           <script type="text/javascript" src="https://api.tgos.tw/TGOS_API/tgos?ver=2&AppID=x+JLVSx85Lk=&APIKey=in8W74q0ogpcfW/STwicK8D5QwCdddJf05/7nb+OtDh8R99YN3T0LurV4xato3TpL/fOfylvJ9Wv/khZEsXEWxsBmg+GEj4AuokiNXCh14Rei21U5GtJpIkO++Mq3AguFK/ISDEWn4hMzqgrkxNe1Q=="charset="utf-8"></script>
           <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		   <script src="https://d3js.org/d3.v3.min.js"></script>
		   <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
		   <script type="text/javascript">
                     var messageBox;                    //訊息視窗物件  
                     var pMap;                      //初始化地圖物件
					 var infotext =  [];        //依序填入地標名稱及訊息視窗內容, 可自行增減數量
                     var markerPoint = [];        //依序填入地標坐標位置, 坐標數須與標記數一致
                     var imgUrl = [];                   //依序設定標記點圖示來源
					 var police = [];
					 d3.csv("嘉義市公立國民中小學.csv", function(data) {
					 console.log("d3.csv on!");
					 school = data;
					 console.log("school "+school.length);
						for (var i = 0;i<school.length;i++){
							infotext.push("<B>校名:"+school[i].校名+"</br>電話:"+school[i].電話+"</br>傳真:"+school[i].傳真+"</br>校址:"+school[i].校址+"</br>LAT:"+school[i].LATITUDE+"</br>LON:"+school[i].LONGITUDE);
							markerPoint.push(new TGOS.TGPoint(school[i].LONGITUDE,school[i].LATITUDE));
							imgUrl.push("https://api.tgos.tw/TGOS_API/images/marker2.png");
						}
							InitWnd();
					 });					 
							//--------------------若網頁介面依照範例網頁的預設設定,以下程式碼可不修改--------------------------                     
							function InitWnd(){
								console.log("initWnd on!");
								console.log("x "+infotext.length);
								//------------------初始化地圖--------------------
                                var pOMap = document.getElementById("OMap");
                                var mapOptiions = {
									scaleControl: false,                //不顯示比例尺
									navigationControl: true,     //顯示地圖縮放控制項
									navigationControlOptions: {        //設定地圖縮放控制項
										controlPosition: TGOS.TGControlPosition.TOP_LEFT,  //控制項位置
										navigationControlStyle: TGOS.TGNavigationControlStyle.SMALL         //控制項樣式
									},
									mapTypeControl: false                   //不顯示地圖類型控制項
                                };
                                pMap = new TGOS.TGOnlineMap(pOMap, TGOS.TGCoordSys.EPSG3857, mapOptiions);    //建立地圖,選擇Google坐標
                                pMap.setZoom(14);   
								pMap.setCenter(new TGOS.TGPoint(120.4491113,23.4800751));      //初始地圖中心點
                               
							   for(var i = 0; i < infotext.length; i++) {
									//------------------建立標記點---------------------
									var markerImg = new TGOS.TGImage(imgUrl[i], new TGOS.TGSize(32, 33), new TGOS.TGPoint(0, 0), new TGOS.TGPoint(10, 33));       //設定標記點圖片及尺寸大小
									var pTGMarker = new TGOS.TGMarker(pMap, markerPoint[i],'', markerImg, {flat:false});   //建立機關單位標記點
									//-----------------建立訊息視窗--------------------
									var InfoWindowOptions = {
										maxWidth:4000,         //訊息視窗的最大寬度
										pixelOffset: new TGOS.TGSize(5, -30), //InfoWindow起始位置的偏移量, 使用TGSize設定, 向右X為正, 向上Y為負 
										opacity:0.8
									};
									messageBox= new TGOS.TGInfoWindow(infotext[i], markerPoint[i], InfoWindowOptions);   //建立訊息視窗                                                                  
									TGOS.TGEvent.addListener(pTGMarker, "click", function (pTGMarker, messageBox) {return function () {messageBox.open(pMap, pTGMarker);}} (pTGMarker, messageBox));//滑鼠監聽事件--開啟訊息視窗
									//TGOS.TGEvent.addListener(pTGMarker, "mouseover", function (pTGMarker, messageBox) {return function () {messageBox.open(pMap, pTGMarker);}} (pTGMarker, messageBox));//滑鼠監聽事件--開啟訊息視窗
									//TGOS.TGEvent.addListener(pTGMarker, "mouseout", function (messageBox) {return function () {messageBox.close();}} (messageBox));																		
									}
									console.log("initWnd off!");
								}
			</script>
</head>
<body>
			<nav class="navbar navbar-default navbar-static-top" role="navigation">
				<div class="container">
					<div class="navbar-header">
						<a class="navbar-brand" href="../index.html">Chiayi</a>
					</div>
					<div>
						<ul class="nav navbar-nav">
							<li><a href="../iot/maptestcode.html">iTaiwan</a></li>
							<li><a href="../social/police.html">police</a></li>
							<li><a href="#">school</a></li>
							<li><a href="../iot/aqi.html">AQI</a></li>
						</ul>
					</div>
				</div>
			</nav>
			<div id="OMap"  class="container" style="width:100%; height:80%; border:1px solid #000000;  float:center;"></div>
			<div style="text-align: center;">
				<a href="https://github.com/17lin/mapproject" target="_blank" id="final_a">網站原始碼 by 資訊科十七</a> /
                資料來源：<a href="https://data.gov.tw/" target="_blank" id="final_a">政府資料開放平台</a> 
			</div>
</body>
</html>
